<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: GoogleViewExt</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">GoogleViewExt</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/slices/google_maps/google_view_ext_rb.html">
                slices/google_maps/google_view_ext.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
All methods noted here become available on all rails views and provide
helpers relating to google maps.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000020">cancel_info_window_link</a>&nbsp;&nbsp;
      <a href="#M000014">google_map</a>&nbsp;&nbsp;
      <a href="#M000013">include_google_javascript</a>&nbsp;&nbsp;
      <a href="#M000017">info_window_form</a>&nbsp;&nbsp;
      <a href="#M000018">info_window_form_for</a>&nbsp;&nbsp;
      <a href="#M000015">link_to_map_script</a>&nbsp;&nbsp;
      <a href="#M000016">link_to_map_script_unless</a>&nbsp;&nbsp;
      <a href="#M000019">prepare_info_window_options</a>&nbsp;&nbsp;
      <a href="#M000012">run_map_script</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="#M000020" class="method-signature">
          <span class="method-name">cancel_info_window_link</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A &#8216;cancel&#8217; link that will close the currently open info window
on the map. Useful when writing forms in info windows.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000020-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000020-source">
<pre>
     <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 126</span>
126:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cancel_info_window_link</span>
127:     <span class="ruby-identifier">link_to_map_script</span> <span class="ruby-value str">'cancel'</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">script</span><span class="ruby-operator">|</span>
128:       <span class="ruby-identifier">script</span>.<span class="ruby-identifier">map</span>.<span class="ruby-identifier">close_info_window</span>
129:     <span class="ruby-keyword kw">end</span>
130:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="#M000014" class="method-signature">
          <span class="method-name">google_map</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a google map div with the given <tt>options</tt>, this is used in
the view to display the map.
</p>
<h4>Options:</h4>
<ul>
<li><tt>id</tt> - Optional. The id of the map the default being <tt>map</tt>

</li>
<li><tt>fullscreen</tt> - Optional. A value indicating if the map should be
fullscreen and take up all the space in the browser window.

</li>
<li><tt>width</tt> - Optional. The width of the map in pixels.

</li>
<li><tt>height</tt> - Optional. The height of the map in pixels.

</li>
<li><tt>style</tt> - Optional. Extra style attributes to be added to the map
provided as standard CSS.

</li>
</ul>
<h4>Examples:</h4>
<pre>
  google_map :fullscreen =&gt; true
  google_map :width =&gt; 600, :height =&gt; 650
  google_map :width =&gt; 600, :height =&gt; 650, :style =&gt; 'border: 1px dashed black; margin: 10px'
  google_map :id =&gt; 'my_cool_map'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000014-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000014-source">
<pre>
    <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">google_map</span>(<span class="ruby-identifier">options</span> = {})
49:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">assert_valid_keys</span> <span class="ruby-identifier">:id</span>, <span class="ruby-identifier">:fullscreen</span>, <span class="ruby-identifier">:width</span>, <span class="ruby-identifier">:height</span>, <span class="ruby-identifier">:style</span>
50:     
51:     <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:id</span>] <span class="ruby-operator">||=</span> <span class="ruby-value str">'map'</span>
52:     
53:     <span class="ruby-identifier">map_style</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:style</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
54:     
55:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">extract</span>(<span class="ruby-identifier">:fullscreen</span>)
56:       <span class="ruby-identifier">map_style</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;position: absolute; top: 0; left: 0;
57:                     height: 100%; width: 100%;
58:                     overflow: hidden;&quot;</span>
59:     <span class="ruby-keyword kw">else</span>
60:       <span class="ruby-identifier">map_style</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;width: #{map_size(options.extract(:width))};&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:width</span>]
61:       <span class="ruby-identifier">map_style</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;height: #{map_size(options.extract(:height))};&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:height</span>]
62:     <span class="ruby-keyword kw">end</span>
63:     
64:     <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:style</span>] = <span class="ruby-identifier">map_style</span>
65:     
66:     <span class="ruby-identifier">content_tag</span> <span class="ruby-identifier">:div</span>, <span class="ruby-value str">'loading map...'</span>, <span class="ruby-identifier">options</span>
67:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="#M000013" class="method-signature">
          <span class="method-name">include_google_javascript</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Includes the required google maps and eschaton javascript files. This must
be called in the view or layout to enable google maps functionality.
</p>
<h4>Options:</h4>
<ul>
<li><tt>key</tt> - Optional. See ApiKey.get or supply the <a
href="http://code.google.com/apis/maps/signup.html">key</a> as an option.

</li>
<li><tt>include_jquery</tt> - Optional. Indicates if the jquery file should be
included, defaulted to <tt>true</tt>, set this to <tt>false</tt> if you
have already included jQuery.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
    <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 22</span>
22:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_google_javascript</span>(<span class="ruby-identifier">options</span> = {})
23:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">default!</span> <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Google</span><span class="ruby-operator">::</span><span class="ruby-constant">ApiKey</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">:domain</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">domain</span>), <span class="ruby-identifier">:include_jquery</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
24: 
25:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">assert_valid_keys</span> <span class="ruby-identifier">:key</span>, <span class="ruby-identifier">:include_jquery</span>
26: 
27:     <span class="ruby-identifier">jquery_script</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">include_jquery_javascript</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:include_jquery</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>
28:     <span class="ruby-identifier">google_script</span> = <span class="ruby-node">&quot;&lt;script src=\&quot;http://maps.google.com/maps?file=api&amp;amp;v=2&amp;amp;key=#{options[:key]}\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;&quot;</span>
29: 
30:     <span class="ruby-identifier">collect</span> <span class="ruby-identifier">google_script</span>, <span class="ruby-identifier">jquery_script</span>,
31:             <span class="ruby-identifier">javascript_include_tag</span>(<span class="ruby-value str">'eschaton'</span>)
32:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="#M000017" class="method-signature">
          <span class="method-name">info_window_form</span><span class="method-args">(options, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Works in exactly the same way as rails <tt>form_remote_tag</tt> but
provides some extra options. This would be used to create a remote form tag
within an info window.
</p>
<h4>Options:</h4>
<ul>
<li><tt>include_location</tt> - Optional. Indicates if latitude and longitude
<tt>params</tt>(if present) should be include in the <tt>url</tt>,
defaulted to <tt>true</tt>.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000017-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000017-source">
<pre>
     <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info_window_form</span>(<span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-comment cmt">#TODO rename =&gt; info_window_form_tag</span>
102:     <span class="ruby-identifier">prepare_info_window_options</span>(<span class="ruby-identifier">options</span>)
103:     
104:     <span class="ruby-identifier">form_remote_tag</span> <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
105:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="#M000018" class="method-signature">
          <span class="method-name">info_window_form_for</span><span class="method-args">(model, model_instance, options, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000018-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000018-source">
<pre>
     <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info_window_form_for</span>(<span class="ruby-identifier">model</span>, <span class="ruby-identifier">model_instance</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
108:     <span class="ruby-identifier">prepare_info_window_options</span>(<span class="ruby-identifier">options</span>)
109:     
110:     <span class="ruby-identifier">remote_form_for</span> <span class="ruby-identifier">model</span>, <span class="ruby-identifier">model_instance</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
111:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="#M000015" class="method-signature">
          <span class="method-name">link_to_map_script</span><span class="method-args">(name, *args) {|script| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Works in much the same as link_to_function but allows for mapping script to
be written within the script block
</p>
<pre>
 link_to_map_script(&quot;Show info&quot;) do |script|
   script.map.open_info_window :text =&gt; 'I am showing some info'
 end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000015-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000015-source">
<pre>
    <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_map_script</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
75:     <span class="ruby-identifier">link_to_function</span> <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">script</span><span class="ruby-operator">|</span>
76:       <span class="ruby-constant">Eschaton</span>.<span class="ruby-identifier">with_global_script</span>(<span class="ruby-identifier">script</span>) <span class="ruby-keyword kw">do</span>
77:         <span class="ruby-identifier">script</span>.<span class="ruby-identifier">with_mapping_scripts</span> <span class="ruby-keyword kw">do</span>
78:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">script</span>
79: 
80:           <span class="ruby-identifier">script</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Google</span><span class="ruby-operator">::</span><span class="ruby-constant">Scripts</span>.<span class="ruby-identifier">extract</span>(<span class="ruby-identifier">:end_of_map_script</span>)
81:         <span class="ruby-keyword kw">end</span>
82:       <span class="ruby-keyword kw">end</span>
83:     <span class="ruby-keyword kw">end</span>
84:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="#M000016" class="method-signature">
          <span class="method-name">link_to_map_script_unless</span><span class="method-args">(condition, name, *args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Unless the <tt>condition</tt> is <tt>true</tt> this will have the same
effect as <a href="GoogleViewExt.html#M000015">link_to_map_script</a>
otherwise <tt>name</tt> will be returned.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000016-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000016-source">
<pre>
    <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_map_script_unless</span>(<span class="ruby-identifier">condition</span>, <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
89:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">condition</span>
90:       <span class="ruby-identifier">link_to_map_script</span> <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
91:     <span class="ruby-keyword kw">else</span>
92:       <span class="ruby-identifier">name</span>
93:     <span class="ruby-keyword kw">end</span>
94:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="#M000019" class="method-signature">
          <span class="method-name">prepare_info_window_options</span><span class="method-args">(options)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000019-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000019-source">
<pre>
     <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 113</span>
113:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare_info_window_options</span>(<span class="ruby-identifier">options</span>)
114:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">default!</span> <span class="ruby-identifier">:include_location</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:html</span> =<span class="ruby-operator">&gt;</span> {}
115: 
116:     <span class="ruby-identifier">include_location</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">extract</span>(<span class="ruby-identifier">:include_location</span>)
117:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">include_location</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:location</span>].<span class="ruby-identifier">not_blank?</span>
118:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:url</span>][<span class="ruby-identifier">:location</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:location</span>]
119:     <span class="ruby-keyword kw">end</span>
120: 
121:     <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:html</span>][<span class="ruby-identifier">:class</span>] = <span class="ruby-identifier">:info_window_form</span>
122:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="#M000012" class="method-signature">
          <span class="method-name">run_map_script</span><span class="method-args">() {|script| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Works in the same way as run_javascript but code is treated as google map
script.
</p>
<pre>
 run_map_script do |script|
   map = Google::Map.new(:controls =&gt; [:small_map, :map_type],
                         :center =&gt; {:latitude =&gt; -33.947, :longitude =&gt; 18.462})
 end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000012-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000012-source">
<pre>
    <span class="ruby-comment cmt"># File slices/google_maps/google_view_ext.rb, line 10</span>
10:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run_map_script</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
11:     <span class="ruby-identifier">run_javascript</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">script</span><span class="ruby-operator">|</span>
12:       <span class="ruby-identifier">script</span>.<span class="ruby-identifier">google_map_script</span> {<span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">script</span>}
13:     <span class="ruby-keyword kw">end</span>
14:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>